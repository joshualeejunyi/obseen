{"log.level":"info","@timestamp":"2024-09-24T17:27:25.734+0800","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).configure","file.name":"instance/beat.go","file.line":828},"message":"Home path: [/usr/share/auditbeat] Config path: [/etc/auditbeat] Data path: [/var/lib/auditbeat] Logs path: [/var/log/auditbeat]","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.736+0800","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).configure","file.name":"instance/beat.go","file.line":836},"message":"Beat ID: 26dddb83-824e-4cff-8a52-e766dc0662c1","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.742+0800","log.logger":"seccomp","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/common/seccomp.loadFilter","file.name":"seccomp/seccomp.go","file.line":125},"message":"Syscall filter successfully installed","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.742+0800","log.logger":"beat","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.logSystemInfo","file.name":"instance/beat.go","file.line":1385},"message":"Beat info","service.name":"auditbeat","system_info":{"beat":{"path":{"config":"/etc/auditbeat","data":"/var/lib/auditbeat","home":"/usr/share/auditbeat","logs":"/var/log/auditbeat"},"type":"auditbeat","uuid":"26dddb83-824e-4cff-8a52-e766dc0662c1"},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.742+0800","log.logger":"beat","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.logSystemInfo","file.name":"instance/beat.go","file.line":1394},"message":"Build info","service.name":"auditbeat","system_info":{"build":{"commit":"88cc526a2d3e52dcbfa52c9dd25eb09ed95470e4","libbeat":"8.15.1","time":"2024-09-02T08:36:18.000Z","version":"8.15.1"},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.742+0800","log.logger":"beat","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.logSystemInfo","file.name":"instance/beat.go","file.line":1397},"message":"Go runtime info","service.name":"auditbeat","system_info":{"go":{"os":"linux","arch":"amd64","max_procs":8,"version":"go1.22.6"},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.743+0800","log.logger":"beat","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.logSystemInfo","file.name":"instance/beat.go","file.line":1403},"message":"Host info","service.name":"auditbeat","system_info":{"host":{"architecture":"x86_64","native_architecture":"amd64","boot_time":"2024-09-24T16:30:00+08:00","containerized":false,"name":"student-virtualbox","ip":["127.0.0.1","::1","192.168.1.65","fe80::6d72:a81d:7d2a:86d0"],"kernel_version":"5.15.0-122-generic","mac":["00:0c:29:bf:ad:b2"],"os":{"type":"linux","family":"debian","platform":"ubuntu","name":"Ubuntu","version":"20.04.3 LTS (Focal Fossa)","major":20,"minor":4,"patch":3,"codename":"focal"},"timezone":"+08","timezone_offset_sec":28800,"id":"2db62cacf90748d9a42baaaa064a8130"},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.744+0800","log.logger":"beat","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.logSystemInfo","file.name":"instance/beat.go","file.line":1432},"message":"Process info","service.name":"auditbeat","system_info":{"process":{"capabilities":{"inheritable":null,"permitted":["chown","dac_override","dac_read_search","fowner","fsetid","kill","setgid","setuid","setpcap","linux_immutable","net_bind_service","net_broadcast","net_admin","net_raw","ipc_lock","ipc_owner","sys_module","sys_rawio","sys_chroot","sys_ptrace","sys_pacct","sys_admin","sys_boot","sys_nice","sys_resource","sys_time","sys_tty_config","mknod","lease","audit_write","audit_control","setfcap","mac_override","mac_admin","syslog","wake_alarm","block_suspend","audit_read","perfmon","bpf","checkpoint_restore"],"effective":["chown","dac_override","dac_read_search","fowner","fsetid","kill","setgid","setuid","setpcap","linux_immutable","net_bind_service","net_broadcast","net_admin","net_raw","ipc_lock","ipc_owner","sys_module","sys_rawio","sys_chroot","sys_ptrace","sys_pacct","sys_admin","sys_boot","sys_nice","sys_resource","sys_time","sys_tty_config","mknod","lease","audit_write","audit_control","setfcap","mac_override","mac_admin","syslog","wake_alarm","block_suspend","audit_read","perfmon","bpf","checkpoint_restore"],"bounding":["chown","dac_override","dac_read_search","fowner","fsetid","kill","setgid","setuid","setpcap","linux_immutable","net_bind_service","net_broadcast","net_admin","net_raw","ipc_lock","ipc_owner","sys_module","sys_rawio","sys_chroot","sys_ptrace","sys_pacct","sys_admin","sys_boot","sys_nice","sys_resource","sys_time","sys_tty_config","mknod","lease","audit_write","audit_control","setfcap","mac_override","mac_admin","syslog","wake_alarm","block_suspend","audit_read","perfmon","bpf","checkpoint_restore"],"ambient":null},"cwd":"/","exe":"/usr/share/auditbeat/bin/auditbeat","name":"auditbeat","pid":5677,"ppid":1,"seccomp":{"mode":"filter","no_new_privs":true},"start_time":"2024-09-24T17:27:24.920+0800"},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.744+0800","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).createBeater","file.name":"instance/beat.go","file.line":341},"message":"Setup Beat: auditbeat; Version: 8.15.1","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.753+0800","log.logger":"file","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/outputs/fileout.(*fileOutput).init","file.name":"fileout/file.go","file.line":105},"message":"Initialized file output. path=/var/log/auditbeat/auditbeat max_size_bytes=8589934592 max_backups=10 permissions=-rw-------","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.754+0800","log.logger":"publisher","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/publisher/pipeline.LoadWithSettings","file.name":"pipeline/module.go","file.line":105},"message":"Beat name: student-VirtualBox","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.755+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.New","file.name":"auditd/audit_linux.go","file.line":108},"message":"auditd module is running as euid=0 on kernel=5.15.0-122-generic","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.806+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.newAuditClient","file.name":"auditd/audit_linux.go","file.line":135},"message":"socket_type=unicast will be used.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.807+0800","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).snapshotLoop","file.name":"log/log.go","file.line":150},"message":"Starting metrics logging every 30s","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:25.808+0800","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).launch","file.name":"instance/beat.go","file.line":540},"message":"auditbeat start running.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:30.254+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.(*MetricSet).addRules","file.name":"auditd/audit_linux.go","file.line":288},"message":"Deleted 0 pre-existing audit rules.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:30.256+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.(*MetricSet).addRules","file.name":"auditd/audit_linux.go","file.line":307},"message":"Successfully added 15 of 15 audit rules.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:30.308+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.(*MetricSet).initClient","file.name":"auditd/audit_linux.go","file.line":334},"message":"audit status from kernel at start","service.name":"auditbeat","audit_status":{"Mask":0,"Enabled":1,"Failure":1,"PID":0,"RateLimit":0,"BacklogLimit":8192,"Lost":0,"Backlog":0,"FeatureBitmap":127,"BacklogWaitTime":0,"BacklogWaitTimeActual":0},"ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:30.309+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.(*MetricSet).initClient","file.name":"auditd/audit_linux.go","file.line":361},"message":"Setting kernel backlog wait time to prevent backpressure propagating to the kernel.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:27:55.812+0800","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logSnapshot","file.name":"log/log.go","file.line":192},"message":"Non-zero metrics in the last 30s","service.name":"auditbeat","monitoring":{"metrics":{"auditd":{"reassembler_seq_gaps":3719441678336,"received_msgs":145330},"beat":{"cgroup":{"memory":{"id":"auditbeat.service","mem":{"limit":{"bytes":9223372036854771712},"usage":{"bytes":134488064}}}},"cpu":{"system":{"ticks":2260,"time":{"ms":2260}},"total":{"ticks":10090,"time":{"ms":10090},"value":10090},"user":{"ticks":7830,"time":{"ms":7830}}},"handles":{"limit":{"hard":524288,"soft":524288},"open":12},"info":{"ephemeral_id":"6bea3519-920c-4846-91ae-d07b8a23bc96","name":"auditbeat","uptime":{"ms":30103},"version":"8.15.1"},"memstats":{"gc_next":67521128,"memory_alloc":54380952,"memory_sys":79546873,"memory_total":1524785840,"rss":145219584},"runtime":{"goroutines":22}},"libbeat":{"config":{"module":{"running":0}},"output":{"events":{"acked":46400,"active":0,"batches":29,"total":46400},"type":"file","write":{"bytes":43962323,"latency":{"histogram":{"count":46400,"max":0,"mean":0,"median":0,"min":0,"p75":0,"p95":0,"p99":0,"p999":0,"stddev":0}}}},"pipeline":{"clients":1,"events":{"active":1522,"published":47922,"total":47922},"queue":{"acked":46400,"added":{"events":47922},"consumed":{"events":46400},"filled":{"bytes":0,"events":1522,"pct":0.475625},"max_bytes":0,"max_events":3200,"removed":{"events":46400}}}},"metricbeat":{"auditd":{"auditd":{"events":47922,"success":47922}}},"system":{"cpu":{"cores":8},"load":{"1":0.41,"15":0.03,"5":0.1,"norm":{"1":0.0513,"15":0.0038,"5":0.0125}}}},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:28:07.376+0800","log.logger":"service","log.origin":{"function":"github.com/elastic/elastic-agent-libs/service.HandleSignals.func1","file.name":"service/service.go","file.line":52},"message":"Received signal \"terminated\", stopping","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:28:07.396+0800","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logTotals","file.name":"log/log.go","file.line":200},"message":"Total metrics","service.name":"auditbeat","monitoring":{"metrics":{"auditd":{"kernel_lost":0,"reassembler_seq_gaps":5493263171584,"received_msgs":266558,"userspace_lost":0},"beat":{"cgroup":{"memory":{"id":"auditbeat.service","mem":{"limit":{"bytes":9223372036854771712},"usage":{"bytes":174112768}}}},"cpu":{"system":{"ticks":3620,"time":{"ms":3620}},"total":{"ticks":17140,"time":{"ms":17140},"value":17140},"user":{"ticks":13520,"time":{"ms":13520}}},"handles":{"limit":{"hard":524288,"soft":524288},"open":9},"info":{"ephemeral_id":"6bea3519-920c-4846-91ae-d07b8a23bc96","name":"auditbeat","uptime":{"ms":41687},"version":"8.15.1"},"memstats":{"gc_next":65852280,"memory_alloc":48833192,"memory_sys":96619001,"memory_total":2663447600,"rss":150671360},"runtime":{"goroutines":4}},"libbeat":{"config":{"module":{"running":0,"starts":0,"stops":0},"reloads":0,"scans":0},"output":{"batches":{"split":0},"events":{"acked":82238,"active":0,"batches":52,"dead_letter":0,"dropped":0,"duplicates":0,"failed":0,"toomany":0,"total":82238},"read":{"bytes":0,"errors":0},"type":"file","write":{"bytes":78756859,"errors":0,"latency":{"histogram":{"count":82238,"max":0,"mean":0,"median":0,"min":0,"p75":0,"p95":0,"p99":0,"p999":0,"stddev":0}}}}},"system":{"cpu":{"cores":8},"load":{"1":0.51,"15":0.04,"5":0.12,"norm":{"1":0.0638,"15":0.005,"5":0.015}}}},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:28:07.396+0800","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logTotals","file.name":"log/log.go","file.line":201},"message":"Uptime: 41.685326307s","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:28:07.396+0800","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).snapshotLoop","file.name":"log/log.go","file.line":168},"message":"Stopping metrics logging.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:28:07.396+0800","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).launch","file.name":"instance/beat.go","file.line":549},"message":"auditbeat stopped.","service.name":"auditbeat","ecs.version":"1.6.0"}
