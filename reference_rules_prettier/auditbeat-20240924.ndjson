{"log.level":"info","@timestamp":"2024-09-24T17:30:48.896+0800","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).configure","file.name":"instance/beat.go","file.line":828},"message":"Home path: [/usr/share/auditbeat] Config path: [/etc/auditbeat] Data path: [/var/lib/auditbeat] Logs path: [/var/log/auditbeat]","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.896+0800","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).configure","file.name":"instance/beat.go","file.line":836},"message":"Beat ID: 26dddb83-824e-4cff-8a52-e766dc0662c1","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.900+0800","log.logger":"seccomp","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/common/seccomp.loadFilter","file.name":"seccomp/seccomp.go","file.line":125},"message":"Syscall filter successfully installed","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.900+0800","log.logger":"beat","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.logSystemInfo","file.name":"instance/beat.go","file.line":1385},"message":"Beat info","service.name":"auditbeat","system_info":{"beat":{"path":{"config":"/etc/auditbeat","data":"/var/lib/auditbeat","home":"/usr/share/auditbeat","logs":"/var/log/auditbeat"},"type":"auditbeat","uuid":"26dddb83-824e-4cff-8a52-e766dc0662c1"},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.900+0800","log.logger":"beat","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.logSystemInfo","file.name":"instance/beat.go","file.line":1394},"message":"Build info","service.name":"auditbeat","system_info":{"build":{"commit":"88cc526a2d3e52dcbfa52c9dd25eb09ed95470e4","libbeat":"8.15.1","time":"2024-09-02T08:36:18.000Z","version":"8.15.1"},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.900+0800","log.logger":"beat","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.logSystemInfo","file.name":"instance/beat.go","file.line":1397},"message":"Go runtime info","service.name":"auditbeat","system_info":{"go":{"os":"linux","arch":"amd64","max_procs":8,"version":"go1.22.6"},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.901+0800","log.logger":"beat","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.logSystemInfo","file.name":"instance/beat.go","file.line":1403},"message":"Host info","service.name":"auditbeat","system_info":{"host":{"architecture":"x86_64","native_architecture":"amd64","boot_time":"2024-09-24T16:30:00+08:00","containerized":false,"name":"student-virtualbox","ip":["127.0.0.1","::1","192.168.1.65","fe80::6d72:a81d:7d2a:86d0"],"kernel_version":"5.15.0-122-generic","mac":["00:0c:29:bf:ad:b2"],"os":{"type":"linux","family":"debian","platform":"ubuntu","name":"Ubuntu","version":"20.04.3 LTS (Focal Fossa)","major":20,"minor":4,"patch":3,"codename":"focal"},"timezone":"+08","timezone_offset_sec":28800,"id":"2db62cacf90748d9a42baaaa064a8130"},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.902+0800","log.logger":"beat","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.logSystemInfo","file.name":"instance/beat.go","file.line":1432},"message":"Process info","service.name":"auditbeat","system_info":{"process":{"capabilities":{"inheritable":null,"permitted":["chown","dac_override","dac_read_search","fowner","fsetid","kill","setgid","setuid","setpcap","linux_immutable","net_bind_service","net_broadcast","net_admin","net_raw","ipc_lock","ipc_owner","sys_module","sys_rawio","sys_chroot","sys_ptrace","sys_pacct","sys_admin","sys_boot","sys_nice","sys_resource","sys_time","sys_tty_config","mknod","lease","audit_write","audit_control","setfcap","mac_override","mac_admin","syslog","wake_alarm","block_suspend","audit_read","perfmon","bpf","checkpoint_restore"],"effective":["chown","dac_override","dac_read_search","fowner","fsetid","kill","setgid","setuid","setpcap","linux_immutable","net_bind_service","net_broadcast","net_admin","net_raw","ipc_lock","ipc_owner","sys_module","sys_rawio","sys_chroot","sys_ptrace","sys_pacct","sys_admin","sys_boot","sys_nice","sys_resource","sys_time","sys_tty_config","mknod","lease","audit_write","audit_control","setfcap","mac_override","mac_admin","syslog","wake_alarm","block_suspend","audit_read","perfmon","bpf","checkpoint_restore"],"bounding":["chown","dac_override","dac_read_search","fowner","fsetid","kill","setgid","setuid","setpcap","linux_immutable","net_bind_service","net_broadcast","net_admin","net_raw","ipc_lock","ipc_owner","sys_module","sys_rawio","sys_chroot","sys_ptrace","sys_pacct","sys_admin","sys_boot","sys_nice","sys_resource","sys_time","sys_tty_config","mknod","lease","audit_write","audit_control","setfcap","mac_override","mac_admin","syslog","wake_alarm","block_suspend","audit_read","perfmon","bpf","checkpoint_restore"],"ambient":null},"cwd":"/","exe":"/usr/share/auditbeat/bin/auditbeat","name":"auditbeat","pid":6099,"ppid":1,"seccomp":{"mode":"filter","no_new_privs":true},"start_time":"2024-09-24T17:30:48.090+0800"},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.902+0800","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).createBeater","file.name":"instance/beat.go","file.line":341},"message":"Setup Beat: auditbeat; Version: 8.15.1","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.913+0800","log.logger":"file","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/outputs/fileout.(*fileOutput).init","file.name":"fileout/file.go","file.line":105},"message":"Initialized file output. path=/var/log/auditbeat/auditbeat max_size_bytes=8589934592 max_backups=10 permissions=-rw-------","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.914+0800","log.logger":"publisher","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/publisher/pipeline.LoadWithSettings","file.name":"pipeline/module.go","file.line":105},"message":"Beat name: student-VirtualBox","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.915+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.New","file.name":"auditd/audit_linux.go","file.line":108},"message":"auditd module is running as euid=0 on kernel=5.15.0-122-generic","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.915+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.newAuditClient","file.name":"auditd/audit_linux.go","file.line":135},"message":"socket_type=unicast will be used.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.915+0800","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).snapshotLoop","file.name":"log/log.go","file.line":150},"message":"Starting metrics logging every 30s","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:48.916+0800","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).launch","file.name":"instance/beat.go","file.line":540},"message":"auditbeat start running.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:58.797+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.(*MetricSet).addRules","file.name":"auditd/audit_linux.go","file.line":288},"message":"Deleted 15 pre-existing audit rules.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:58.797+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.(*MetricSet).addRules","file.name":"auditd/audit_linux.go","file.line":307},"message":"Successfully added 15 of 15 audit rules.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:58.849+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.(*MetricSet).initClient","file.name":"auditd/audit_linux.go","file.line":334},"message":"audit status from kernel at start","service.name":"auditbeat","audit_status":{"Mask":0,"Enabled":1,"Failure":0,"PID":0,"RateLimit":0,"BacklogLimit":8192,"Lost":0,"Backlog":0,"FeatureBitmap":127,"BacklogWaitTime":0,"BacklogWaitTimeActual":0},"ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:30:58.849+0800","log.logger":"auditd","log.origin":{"function":"github.com/elastic/beats/v7/auditbeat/module/auditd.(*MetricSet).initClient","file.name":"auditd/audit_linux.go","file.line":361},"message":"Setting kernel backlog wait time to prevent backpressure propagating to the kernel.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:31:06.262+0800","log.logger":"service","log.origin":{"function":"github.com/elastic/elastic-agent-libs/service.HandleSignals.func1","file.name":"service/service.go","file.line":52},"message":"Received signal \"terminated\", stopping","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:31:06.288+0800","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logTotals","file.name":"log/log.go","file.line":200},"message":"Total metrics","service.name":"auditbeat","monitoring":{"metrics":{"auditd":{"kernel_lost":0,"reassembler_seq_gaps":1318554959872,"received_msgs":73384,"userspace_lost":0},"beat":{"cgroup":{"memory":{"id":"auditbeat.service","mem":{"limit":{"bytes":9223372036854771712},"usage":{"bytes":126496768}}}},"cpu":{"system":{"ticks":670,"time":{"ms":670}},"total":{"ticks":4390,"time":{"ms":4390},"value":4390},"user":{"ticks":3720,"time":{"ms":3720}}},"handles":{"limit":{"hard":524288,"soft":524288},"open":9},"info":{"ephemeral_id":"ede692aa-166e-4a84-b25f-d16ccbb82505","name":"auditbeat","uptime":{"ms":17403},"version":"8.15.1"},"memstats":{"gc_next":71455504,"memory_alloc":57903416,"memory_sys":92686841,"memory_total":726996936,"rss":152293376},"runtime":{"goroutines":3}},"libbeat":{"config":{"module":{"running":0,"starts":0,"stops":0},"reloads":0,"scans":0},"output":{"batches":{"split":0},"events":{"acked":19951,"active":0,"batches":13,"dead_letter":0,"dropped":0,"duplicates":0,"failed":0,"toomany":0,"total":19951},"read":{"bytes":0,"errors":0},"type":"file","write":{"bytes":28786899,"errors":0,"latency":{"histogram":{"count":19951,"max":0,"mean":0,"median":0,"min":0,"p75":0,"p95":0,"p99":0,"p999":0,"stddev":0}}}}},"system":{"cpu":{"cores":8},"load":{"1":0.29,"15":0.12,"5":0.28,"norm":{"1":0.0363,"15":0.015,"5":0.035}}}},"ecs.version":"1.6.0"}}
{"log.level":"info","@timestamp":"2024-09-24T17:31:06.288+0800","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).logTotals","file.name":"log/log.go","file.line":201},"message":"Uptime: 17.399160631s","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:31:06.288+0800","log.logger":"monitoring","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/monitoring/report/log.(*reporter).snapshotLoop","file.name":"log/log.go","file.line":168},"message":"Stopping metrics logging.","service.name":"auditbeat","ecs.version":"1.6.0"}
{"log.level":"info","@timestamp":"2024-09-24T17:31:06.288+0800","log.origin":{"function":"github.com/elastic/beats/v7/libbeat/cmd/instance.(*Beat).launch","file.name":"instance/beat.go","file.line":549},"message":"auditbeat stopped.","service.name":"auditbeat","ecs.version":"1.6.0"}
